<% grouped_per_project_demand_list.each_pair do |project, demands| %>
  <h3><%= project.full_name %></h3>

  <table class="table table-index">
    <thead>
      <tr>
        <th><%= Demand.human_attribute_name :demand_id %></th>
        <th><%= Demand.human_attribute_name :demand_type %></th>
        <th><%= Demand.human_attribute_name :class_of_service %></th>
        <th><%= Demand.human_attribute_name :commitment_date %></th>
        <th><%= Demand.human_attribute_name :end_date %></th>
        <th><%= Demand.human_attribute_name :leadtime %></th>
        <th><%= t('demands.index.total_working_time') %></th>
        <th><%= t('demands.index.blocked_working_time') %></th>
        <th><%= Demand.human_attribute_name :effort %></th>
        <th><%= Demand.human_attribute_name(:url).upcase %></th>
        <th><%= t('general.table.actions') %></th>
      </tr>
    </thead>
    <tbody>
      <% demands.each do |demand| %>
        <tr>
          <td><%= link_to demand.demand_id, company_project_project_result_demand_path(demand.company, demand.project, demand.project_result, demand) %></td>
          <td><%= t("activerecord.attributes.demand.enums.demand_type.#{demand.demand_type}") %></td>
          <td><%= t("activerecord.attributes.demand.enums.class_of_service.#{demand.class_of_service}") %></td>
          <td><%= l(demand.commitment_date, format: :short) if demand.commitment_date.present? %></td>
          <td><%= l(demand.end_date, format: :short) if demand.end_date.present? %></td>
          <td><%= time_ago_in_words(demand.leadtime.seconds.ago) if demand.leadtime.present? %></td>
          <td><%= number_with_precision(demand.total_working_time, precision: 2) %></td>
          <td><%= number_with_precision(demand.blocked_working_time, precision: 2) %></td>
          <td><%= number_with_precision(demand.effort, precision: 2) %></td>
          <td><%= link_to demand.url, demand.url %></td>
          <td>
            <%= link_to company_project_project_result_demand_path(demand.company, demand.project, demand.project_result, demand), method: :delete do %>
              <i class="fa fa-times" aria-hidden="true"></i>
            <% end %>
            <%= link_to edit_company_project_project_result_demand_path(demand.company, demand.project, demand.project_result, demand) do %>
              <i class="fas fa-edit"></i>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
