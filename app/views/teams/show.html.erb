<div class="row">
  <div class="col-xs-10">
    <ul class="breadcrumb">
      <li><%= link_to I18n.t('general.home.title'), root_path %></li>
      <li><%= link_to @company.abbreviation&.upcase, company_path(@company) %></li>
      <li><%= Team.model_name.human(count: 2) %></li>
      <li><%= @team.name %></li>
    </ul>
  </div>

  <div class="col-xs-2 pull-right">
    <div class="dropdown topnav-right">

      <i class="fas fa-cogs dropdown-toggle main-config-cogs" data-toggle='dropdown'></i>

      <ul class="dropdown-menu dropdown-menu-right">
        <%= render 'teams/team_menu', company: @company, team: @team %>
      </ul>
    </div>
  </div>
</div>

<%= hidden_field_tag :company_id, @company.id %>
<%= hidden_field_tag :team_id, @team.id %>
<%= hidden_field_tag :teams_ids, [@team.id] %>
<%= hidden_field_tag :target_name, @team.name %>
<%= hidden_field_tag :projects_ids, @projects.map(&:id).join(',') %>
<%= hidden_field_tag :demands_ids, @demands_ids.join(',') %>

<%= render 'layouts/load_spinner' %>

<div class="row">
  <div class="col-xs-12 center">
    <hr>
  </div>
</div>

<div class="row">
  <div class="col-xs-12 center">
    <div class="tab">
      <button class="tablinks" id="team-dashboard-tab"><%= I18n.t('teams.show.dashboard_tab') %></button>
      <button class="tablinks" id="team-demands-tab"><%= I18n.t('teams.show.demands_tab') %></button>
      <button class="tablinks" id="team-replenishing-tab"><%= I18n.t('navbar.replenishing') %></button>
    </div>
  </div>
</div>

<div id="dashboard-controls">
  <div class="row bottom-spaced-component" id="page-buttons">
    <div class="col-xs-12 center">
      <div class="tab">
        <button class="tablinks btn btn-sm" id="team-dashboard-page-one"><%= I18n.t('general.page.one') %></button>
        <button class="tablinks btn btn-sm" id="team-dashboard-page-two"><%= I18n.t('general.page.two') %></button>
        <button class="tablinks btn btn-sm" id="team-dashboard-page-three"><%= I18n.t('general.page.three') %></button>
      </div>
    </div>
  </div>

  <%= render 'teams/dashboard_filter', start_date: @start_date, end_date: @end_date %>

</div>

<hr>

<div id="team-dashboard-container-page-one" class="tabcontent">
  <%= render 'teams/dashboard_body',
             team: @team,
             slack_configurations: @slack_configurations,
             memberships: @memberships,
             dates_array: @array_of_dates,
             work_item_flow_information: @work_item_flow_information,
             time_flow_informations: @time_flow_informations,
             statistics_flow_information: @statistics_flow_information,
             demands_chart_adapter: @demands_chart_adapter,
             demands_ids: @demands.map(&:id) %>
</div>

<div id="team-dashboard-container-page-two" class="tabcontent">

</div>

<div id="team-dashboard-container-page-three" class="tabcontent">

</div>

<div id="team-replenishing-container" class="tabcontent">

</div>

<div id="team-demands-info" class="tabcontent">
  <%= render 'demands/demands_table', company: @company, demands: @paged_demands, unpaged_demands: @demands %>
</div>

<div class="modal fade" id="edit-demand-form" tabindex="-1" role="dialog" aria-labelledby="edit-demand-form" aria-hidden="true"></div>

<% content_for :javascript do %>
  <%= javascript_include_tag 'charts/donut' %>
  <%= javascript_include_tag 'charts/column' %>
  <%= javascript_include_tag 'charts/line' %>
  <%= javascript_include_tag 'charts/burnup' %>
  <%= javascript_include_tag 'charts/histogram' %>
  <%= javascript_include_tag 'charts/stacked_area' %>
  <%= javascript_include_tag 'charts/scatter' %>

  <%= javascript_include_tag 'components/components' %>

  <%= javascript_include_tag 'routes/team_routes' %>
  <%= javascript_include_tag 'routes/demand_routes' %>

  <%= javascript_include_tag 'teams/team_start_charts' %>
  <%= javascript_include_tag 'teams/team_tabs_behaviour' %>
  <%= javascript_include_tag 'teams/show' %>

  <%= javascript_include_tag 'demands/form_modal' %>
<% end %>
