dist: trusty
sudo: required
env:
  global:
  - PGPORT=5433
  - CC_TEST_REPORTER_ID=70ab5420793b8b581d83df1dc8dcc49ca7c48d3deb51c9f9a8c2a5e0899c8f71
language: ruby
cache: bundler
rvm:
- 2.4.3
services:
- postgresql
addons:
  postgresql: '10'
  apt:
    packages:
    - postgresql-10
    - postgresql-client-10
before_script:
- cp config/database.yml.travis config/database.yml
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
  > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- "./cc-test-reporter before-build"
script:
- RAILS_ENV=test bundle exec rake db:create --trace
- RAILS_ENV=test bundle exec rake db:migrate --trace
- bundle exec rake db:test:prepare
- bundle exec rspec spec/
- bundle exec rubocop -DR
- bundle exec rake assets:precompile
- git add public/assets
- git commit -am 'assets precompiled'
after_script:
- "./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT"
deploy:
  provider: heroku
  api_key:
    secure: JLHHB2TL1q8JAUcRHyEWUa5Seup+oYWjCB7yVZKABvH/CgJyCYDZOHsYTd3NOt54iD8VNwyMSDqu34xmM8is7GgOuGycPQZUvlD6Y0XvdGVTmY6KFLrOlls+wz2B37HA24cM7L2MLGWETJ5IInff6YF81etiQ9SxdG5tPFXMuRoay6OSLhTfA4+d1UbdfoXy9RCa7ezi2O/HwAMZv6fMdFkWasXuL+Pzwl3YpzXuAFpliPwtoOK2v6ZRu51m3vuNzdszgvCsuNXtH73jEU3MsaCx1wo+Uc8ypZ5iQT3F/MWrsT5GsCCHJtHhru71unwP+/gW9neC1yhyW48xAjrnqpKB31gbLBls/BYa/TyzzcY7WDOjf/koxjkP9GSPHRWjtR/q5k1dsAecKFTMy2Uf3rx3ZFTfvxSBy/fBm7H+lWBqBrktAWCryHHi29AvOdqY4nrFXm9JKtpdgC4KnANyHlumA94AeJx0V2rts2amcbq2prXmuQnIydi5HSlKbjrfel8Q1nvZPQRaldw19V19Def2Ks3pblXk3DGR80VWs7y+l0PaajUONsE/c1dtRs3MU4eVkBLC8uok6YQvgLIipcb+wobY876BPnZfP3vnevyP4cIFiTNRce31z7u1E7hhWCVhSI0cDvyOCcmoGx7WBqA7xL0a+01uLuRQmwqx+fY=
  run: rake db:migrate
  app:
    develop: flowclimatestaging
    master: flowclimateapp
  on:
    repo: TallerWebSolutions/flow_climate
